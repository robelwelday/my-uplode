"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[358],{358:(e,a,t)=>{t.r(a),t.d(a,{default:()=>i});var n=t(555),r=t(43),l=t(576),o=t(931),s=t(579);const i=function(){var e,a;const t=(0,l.Zp)(),[i,d]=(0,r.useState)([]),[c,p]=(0,r.useState)([]),[m,u]=(0,r.useState)(!0),[g,h]=(0,r.useState)(null),[x,A]=(0,r.useState)({name:{en:"",am:"",ti:""},description:{en:"",am:"",ti:""},price:"",image:null}),[b,v]=(0,r.useState)({title:{},content:{},coverImage:null}),[N,j]=(0,r.useState)(null),[y,f]=(0,r.useState)(null),[w,C]=(0,r.useState)(null),[S,T]=(0,r.useState)(null);return(0,r.useEffect)(()=>{localStorage.getItem("adminToken")?(u(!0),h(null),Promise.all([o.A.get("/api/products").then(e=>d(e.data)).catch(e=>{throw new Error("Failed to load products")}),o.A.get("/api/news").then(e=>p(e.data)).catch(e=>{throw new Error("Failed to load news")})]).catch(e=>{h(e.message)}).finally(()=>u(!1))):t("/admin/login")},[t]),m?(0,s.jsx)("p",{className:"text-center text-lg text-gray-600 animate-pulse",children:"Loading..."}):g?(0,s.jsx)("p",{className:"text-center text-red-500 text-lg bg-red-100 p-4 rounded-lg shadow-md",children:g}):(0,s.jsxs)("div",{className:"p-8 bg-gray-100 min-h-screen",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold mb-8 text-center",children:"Admin Dashboard"}),(0,s.jsxs)("section",{className:"mb-12",children:[(0,s.jsx)("h3",{className:"text-2xl font-semibold mb-4",children:"Manage Products"}),(0,s.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a=new FormData;a.append("name",JSON.stringify(x.name)),a.append("description",JSON.stringify(x.description)),a.append("price",x.price),x.image&&a.append("image",x.image),console.log("FormData for product:",Object.fromEntries(a));try{const t=localStorage.getItem("adminToken"),n=await o.A.post("/api/products",a,{headers:{Authorization:"Bearer ".concat(t)}});d(e=>[...e,n.data]),A({name:{en:"",am:"",ti:""},description:{en:"",am:"",ti:""},price:"",image:null}),e.target.reset()}catch(n){var t;console.error("Failed to add product:",(null===(t=n.response)||void 0===t?void 0:t.data)||n.message)}},className:"bg-white p-6 rounded shadow mb-6",children:[(0,s.jsx)("h4",{className:"text-xl font-bold mb-4",children:"Add New Product"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)("input",{type:"text",placeholder:"Name (English)",onChange:e=>A((0,n.A)((0,n.A)({},x),{},{name:(0,n.A)((0,n.A)({},x.name),{},{en:e.target.value})})),required:!0,className:"p-3 border rounded"}),(0,s.jsx)("input",{type:"text",placeholder:"Name (Amharic)",onChange:e=>A((0,n.A)((0,n.A)({},x),{},{name:(0,n.A)((0,n.A)({},x.name),{},{am:e.target.value})})),required:!0,className:"p-3 border rounded"}),(0,s.jsx)("input",{type:"text",placeholder:"Name (Tigrinya)",onChange:e=>A((0,n.A)((0,n.A)({},x),{},{name:(0,n.A)((0,n.A)({},x.name),{},{ti:e.target.value})})),required:!0,className:"p-3 border rounded"}),(0,s.jsx)("textarea",{placeholder:"Description (English)",onChange:e=>A((0,n.A)((0,n.A)({},x),{},{description:(0,n.A)((0,n.A)({},x.description),{},{en:e.target.value})})),required:!0,className:"p-3 border rounded md:col-span-3"}),(0,s.jsx)("textarea",{placeholder:"Description (Amharic)",onChange:e=>A((0,n.A)((0,n.A)({},x),{},{description:(0,n.A)((0,n.A)({},x.description),{},{am:e.target.value})})),required:!0,className:"p-3 border rounded md:col-span-3"}),(0,s.jsx)("textarea",{placeholder:"Description (Tigrinya)",onChange:e=>A((0,n.A)((0,n.A)({},x),{},{description:(0,n.A)((0,n.A)({},x.description),{},{ti:e.target.value})})),required:!0,className:"p-3 border rounded md:col-span-3"}),(0,s.jsx)("input",{type:"number",placeholder:"Price",onChange:e=>A((0,n.A)((0,n.A)({},x),{},{price:e.target.value})),required:!0,className:"p-3 border rounded"}),(0,s.jsx)("input",{type:"file",onChange:e=>A((0,n.A)((0,n.A)({},x),{},{image:e.target.files[0]})),required:!0,className:"p-3 border rounded md:col-span-2"})]}),(0,s.jsx)("button",{type:"submit",className:"mt-4 bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Add Product"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(e=>{var a;return(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h4",{className:"text-lg font-bold break-words whitespace-pre-wrap",children:(null===(a=e.name)||void 0===a?void 0:a.en)||"Unnamed Product"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Price: Birr ",e.price||"N/A"]}),(0,s.jsx)("p",{className:"mt-2 text-sm font-bold ".concat(e.available?"text-green-500":"text-red-500"),children:e.available?"Available":"Unavailable"}),(0,s.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,s.jsx)("button",{onClick:()=>(async(e,a)=>{try{const t=localStorage.getItem("adminToken"),r=await o.A.put("/api/products/".concat(e,"/toggle-availability"),{available:!a},{headers:{Authorization:"Bearer ".concat(t)}});d(a=>a.map(a=>a._id===e?(0,n.A)((0,n.A)({},a),{},{available:r.data.available}):a))}catch(r){var t;console.error("Failed to toggle availability:",(null===(t=r.response)||void 0===t?void 0:t.data)||r.message)}})(e._id,e.available),className:"text-blue-600 hover:underline",children:"Toggle Availability"}),(0,s.jsx)("button",{onClick:()=>{j(e),f((0,n.A)({},e))},className:"text-green-600 hover:underline",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>(async e=>{try{const a=localStorage.getItem("adminToken");await o.A.delete("/api/products/".concat(e),{headers:{Authorization:"Bearer ".concat(a)}}),d(a=>a.filter(a=>a._id!==e))}catch(a){console.error("Failed to delete product:",a)}})(e._id),className:"text-red-600 hover:underline",children:"Delete"})]})]},e._id)})}),N&&y&&(0,s.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!N)return;const a=new FormData;a.append("name",JSON.stringify(y.name)),a.append("description",JSON.stringify(y.description)),y.image instanceof File&&a.append("image",y.image);try{const e=localStorage.getItem("adminToken"),t=await o.A.patch("/api/products/".concat(N._id),a,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});d(e=>e.map(e=>e._id===N._id?t.data:e)),j(null),f(null)}catch(n){var t;console.error("Failed to update product:",(null===(t=n.response)||void 0===t?void 0:t.data)||n.message)}},className:"bg-white p-6 rounded shadow my-6",children:[(0,s.jsxs)("h4",{className:"text-xl font-bold mb-4",children:["Edit Product: ",null===(e=N.name)||void 0===e?void 0:e.en]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)("input",{type:"text",value:y.name.en,onChange:e=>f((0,n.A)((0,n.A)({},y),{},{name:(0,n.A)((0,n.A)({},y.name),{},{en:e.target.value})})),className:"p-3 border rounded",placeholder:"Name (English)"}),(0,s.jsx)("input",{type:"text",value:y.name.am,onChange:e=>f((0,n.A)((0,n.A)({},y),{},{name:(0,n.A)((0,n.A)({},y.name),{},{am:e.target.value})})),className:"p-3 border rounded",placeholder:"Name (Amharic)"}),(0,s.jsx)("input",{type:"text",value:y.name.ti,onChange:e=>f((0,n.A)((0,n.A)({},y),{},{name:(0,n.A)((0,n.A)({},y.name),{},{ti:e.target.value})})),className:"p-3 border rounded",placeholder:"Name (Tigrinya)"}),(0,s.jsx)("textarea",{value:y.description.en,onChange:e=>f((0,n.A)((0,n.A)({},y),{},{description:(0,n.A)((0,n.A)({},y.description),{},{en:e.target.value})})),className:"p-3 border rounded md:col-span-3",placeholder:"Description (English)"}),(0,s.jsx)("textarea",{value:y.description.am,onChange:e=>f((0,n.A)((0,n.A)({},y),{},{description:(0,n.A)((0,n.A)({},y.description),{},{am:e.target.value})})),className:"p-3 border rounded md:col-span-3",placeholder:"Description (Amharic)"}),(0,s.jsx)("textarea",{value:y.description.ti,onChange:e=>f((0,n.A)((0,n.A)({},y),{},{description:(0,n.A)((0,n.A)({},y.description),{},{ti:e.target.value})})),className:"p-3 border rounded md:col-span-3",placeholder:"Description (Tigrinya)"}),(0,s.jsx)("input",{type:"file",onChange:e=>f((0,n.A)((0,n.A)({},y),{},{image:e.target.files[0]})),className:"p-3 border rounded md:col-span-3"})]}),(0,s.jsxs)("div",{className:"mt-4 flex space-x-4",children:[(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Update Product"}),(0,s.jsx)("button",{type:"button",onClick:()=>{j(null),f(null)},className:"bg-gray-300 px-6 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})]}),(0,s.jsxs)("section",{className:"mb-12",children:[(0,s.jsx)("h3",{className:"text-2xl font-semibold mb-4",children:"Manage News"}),(0,s.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a=new FormData;a.append("title",JSON.stringify(b.title)),a.append("content",JSON.stringify(b.content)),b.coverImage&&a.append("coverImage",b.coverImage),console.log("FormData for news:",Object.fromEntries(a));try{const t=localStorage.getItem("adminToken"),n=await o.A.post("/api/news",a,{headers:{Authorization:"Bearer ".concat(t)}});p(e=>[...e,n.data]),v({title:{},content:{},coverImage:null}),e.target.reset()}catch(n){var t;console.error("Failed to add news:",(null===(t=n.response)||void 0===t?void 0:t.data)||n.message)}},className:"bg-white p-6 rounded shadow mb-6",children:[(0,s.jsx)("h4",{className:"text-xl font-bold mb-4",children:"Add New News"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)("input",{type:"text",placeholder:"Title (English)",onChange:e=>v((0,n.A)((0,n.A)({},b),{},{title:(0,n.A)((0,n.A)({},b.title),{},{en:e.target.value})})),required:!0,className:"p-3 border rounded"}),(0,s.jsx)("input",{type:"text",placeholder:"Title (Amharic)",onChange:e=>v((0,n.A)((0,n.A)({},b),{},{title:(0,n.A)((0,n.A)({},b.title),{},{am:e.target.value})})),required:!0,className:"p-3 border rounded"}),(0,s.jsx)("input",{type:"text",placeholder:"Title (Tigrinya)",onChange:e=>v((0,n.A)((0,n.A)({},b),{},{title:(0,n.A)((0,n.A)({},b.title),{},{ti:e.target.value})})),required:!0,className:"p-3 border rounded"}),(0,s.jsx)("textarea",{placeholder:"Content (English)",onChange:e=>v((0,n.A)((0,n.A)({},b),{},{content:(0,n.A)((0,n.A)({},b.content),{},{en:e.target.value})})),required:!0,className:"p-3 border rounded md:col-span-3"}),(0,s.jsx)("textarea",{placeholder:"Content (Amharic)",onChange:e=>v((0,n.A)((0,n.A)({},b),{},{content:(0,n.A)((0,n.A)({},b.content),{},{am:e.target.value})})),required:!0,className:"p-3 border rounded md:col-span-3"}),(0,s.jsx)("textarea",{placeholder:"Content (Tigrinya)",onChange:e=>v((0,n.A)((0,n.A)({},b),{},{content:(0,n.A)((0,n.A)({},b.content),{},{ti:e.target.value})})),required:!0,className:"p-3 border rounded md:col-span-3"}),(0,s.jsx)("input",{type:"file",onChange:e=>v((0,n.A)((0,n.A)({},b),{},{coverImage:e.target.files[0]})),required:!0,className:"p-3 border rounded md:col-span-3"})]}),(0,s.jsx)("button",{type:"submit",className:"mt-4 bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Add News"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(e=>{var a;return(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h4",{className:"text-lg font-bold break-words whitespace-pre-wrap",children:(null===(a=e.title)||void 0===a?void 0:a.en)||"Untitled News"}),(0,s.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,s.jsx)("button",{onClick:()=>{C(e),T((0,n.A)({},e))},className:"text-green-600 hover:underline",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>(async e=>{try{const a=localStorage.getItem("adminToken");await o.A.delete("/api/news/".concat(e),{headers:{Authorization:"Bearer ".concat(a)}}),p(a=>a.filter(a=>a._id!==e))}catch(a){console.error("Failed to delete news:",a)}})(e._id),className:"mt-2 text-red-600 hover:underline",children:"Delete"})]})]},e._id)})}),w&&S&&(0,s.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!w)return;const a=new FormData;a.append("title",JSON.stringify(S.title)),a.append("content",JSON.stringify(S.content)),S.coverImage instanceof File&&a.append("coverImage",S.coverImage);try{const e=localStorage.getItem("adminToken"),t=await o.A.patch("/api/news/".concat(w._id),a,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});p(e=>e.map(e=>e._id===w._id?t.data:e)),C(null),T(null)}catch(n){var t;console.error("Failed to update news:",(null===(t=n.response)||void 0===t?void 0:t.data)||n.message)}},className:"bg-white p-6 rounded shadow my-6",children:[(0,s.jsxs)("h4",{className:"text-xl font-bold mb-4",children:["Edit News: ",null===(a=w.title)||void 0===a?void 0:a.en]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)("input",{type:"text",value:S.title.en||"",onChange:e=>T((0,n.A)((0,n.A)({},S),{},{title:(0,n.A)((0,n.A)({},S.title),{},{en:e.target.value})})),className:"p-3 border rounded",placeholder:"Title (English)"}),(0,s.jsx)("input",{type:"text",value:S.title.am||"",onChange:e=>T((0,n.A)((0,n.A)({},S),{},{title:(0,n.A)((0,n.A)({},S.title),{},{am:e.target.value})})),className:"p-3 border rounded",placeholder:"Title (Amharic)"}),(0,s.jsx)("input",{type:"text",value:S.title.ti||"",onChange:e=>T((0,n.A)((0,n.A)({},S),{},{title:(0,n.A)((0,n.A)({},S.title),{},{ti:e.target.value})})),className:"p-3 border rounded",placeholder:"Title (Tigrinya)"}),(0,s.jsx)("textarea",{value:S.content.en||"",onChange:e=>T((0,n.A)((0,n.A)({},S),{},{content:(0,n.A)((0,n.A)({},S.content),{},{en:e.target.value})})),className:"p-3 border rounded md:col-span-3",placeholder:"Content (English)"}),(0,s.jsx)("textarea",{value:S.content.am||"",onChange:e=>T((0,n.A)((0,n.A)({},S),{},{content:(0,n.A)((0,n.A)({},S.content),{},{am:e.target.value})})),className:"p-3 border rounded md:col-span-3",placeholder:"Content (Amharic)"}),(0,s.jsx)("textarea",{value:S.content.ti||"",onChange:e=>T((0,n.A)((0,n.A)({},S),{},{content:(0,n.A)((0,n.A)({},S.content),{},{ti:e.target.value})})),className:"p-3 border rounded md:col-span-3",placeholder:"Content (Tigrinya)"}),(0,s.jsx)("input",{type:"file",onChange:e=>T((0,n.A)((0,n.A)({},S),{},{coverImage:e.target.files[0]})),className:"p-3 border rounded md:col-span-3"})]}),(0,s.jsxs)("div",{className:"mt-4 flex space-x-4",children:[(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Update News"}),(0,s.jsx)("button",{type:"button",onClick:()=>{C(null),T(null)},className:"bg-gray-300 px-6 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]})]})]})}},931:(e,a,t)=>{t.d(a,{A:()=>n});const n=t(722).A.create({baseURL:""})}}]);
//# sourceMappingURL=358.34aa8587.chunk.js.map